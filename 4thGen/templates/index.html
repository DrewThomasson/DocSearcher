<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PDF Exact Word Page Finder (OCR)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="/static/style.css">
<script>
window.APP_CONFIG = {
  highlightColor: "{{ highlight_color }}",
  buildVersion: "buffered-highlights-2"
};
</script>
<style>
#processingOverlay .close-btn {
  display:none;
  margin-top:4px;
  background:#444;
  color:#eee;
  padding:6px 14px;
  border-radius:20px;
  font-size:13px;
  cursor:pointer;
  border:1px solid #666;
}
#processingOverlay .close-btn:hover { background:#555; }
#processingOverlay .error-line {
  font-size:12px;
  color:#ff6666;
  margin:0;
  display:none;
  max-width:480px;
  word-break:break-word;
}
</style>
</head>
<body>
<header>
  <h1>PDF Exact Word Page Finder</h1>
  <div class="controls">
    <div class="block">
      <label class="btn">
        <input type="file" id="pdfInput" accept="application/pdf" hidden>
        <span>Upload PDF</span>
      </label>
      <span id="fileInfo" class="dim"></span>
    </div>

    <div class="block">
      <label style="display:flex;align-items:center;gap:4px;font-size:12px;">
        <input type="checkbox" id="ocrToggle">
        OCR
      </label>
      <input type="text" id="ocrLang" placeholder="eng" style="width:80px;">
    </div>

    <div class="block grow">
      <input type="text" id="wordsInput" placeholder="Enter words (space / comma separated)" autocomplete="off">
    </div>

    <button id="searchBtn" class="primary">Search</button>

    <div class="block">
      <button id="zoomOut" disabled>-</button>
      <span id="zoomVal">100%</span>
      <button id="zoomIn" disabled>+</button>
    </div>

    <div class="block">
      <button id="loadAllBtn" disabled title="Load any remaining pages">Load All Pages</button>
    </div>

    <div class="block">
      <a id="downloadOcrLink" class="btn btn-secondary" style="display:none;">Download OCR PDF</a>
    </div>
  </div>
</header>

<main id="layout">
  <aside id="sidebar">
    <section>
      <h2>Legend</h2>
      <div id="legend" class="legend"><span class="dim">No words</span></div>
    </section>
    <section>
      <h2>Pages with Matches</h2>
      <ul id="resultsList" class="results"></ul>
      <p class="note">Case-insensitive whole-token matching.</p>
      <p class="note" id="ocrStatusNote" style="display:none;"></p>
    </section>
    <section>
      <h2>Page Text</h2>
      <textarea id="pageText" placeholder="Select a page result"></textarea>
    </section>
  </aside>
  <div id="divider" title="Drag to resize sidebar"></div>
  <section id="pagesWrap">
    <div id="pages"></div>
  </section>
</main>

<div id="statusBar"><span id="statusMsg">Ready.</span></div>

<div id="processingOverlay" class="hidden" aria-live="polite">
  <div class="overlay-content">
    <div class="spinner" id="processingSpinner"></div>
    <h2 id="processingTitle">Processing PDF...</h2>
    <p id="processingDetail" class="detail"></p>
    <p class="hint" id="processingHint">
      Do not close this tab. OCR can take time on large or scanned PDFs.
    </p>
    <p class="error-line" id="processingError"></p>
    <button type="button" id="overlayCloseBtn" class="close-btn">Close</button>
  </div>
</div>

<script src="/static/app.js?v=buffered-highlights-2"></script>
</body>
</html>